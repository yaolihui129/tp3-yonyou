/*! SendCloud-Front-End-App  by xuhong (c@sendcloud.im) */
require.config({paths:{echarts:"/lib/echarts"}}),require(["echarts","echarts/chart/line","echarts/chart/map"],function(a){function b(){$.get("/systemdata/eventDataInMinute.do").done(function(a){function b(){if(l>=60)return void clearInterval(c);if(j[l])for(var a in j[l]){(0==a||a>33)&&(a=parseInt(16*Math.random()+1,10));var b=f[e[a]],m={name:e[a],value:j[l][a],geoCoord:[b[0],b[1]]};d.push(m)}if(k[l])for(var a in k[l]){(0==a||a>33)&&(a=parseInt(16*Math.random()+1,10));var b=f[e[a]],m={name:e[a],value:k[l][a],geoCoord:[b[0],b[1]]};i.push(m)}g.series[0].markPoint.data=d,g.series[1].markPoint.data=i,h.setOption(g),l++,setTimeout(function(){g.series[0].markPoint.data.length=0,g.series[1].markPoint.data.length=0,h.setOption(g)},4e3)}var c,d=g.series[0].markPoint.data||[],i=g.series[1].markPoint.data||[],j=JSON.parse(a.data.openNumInMinute),k=JSON.parse(a.data.clickNumInMinute),l=0;clearInterval(c),c=setInterval(b,4e3)})}function c(){$.get("/systemdata/initSendData.do").done(function(a){var b=[],c=[];for(i in a.data.deliveredData)b.push(parseInt(a.data.deliveredData[i],10));for(var d in a.data.requestData)c.push(parseInt(a.data.requestData[d],10));for(var e=new Date,f=[],g=6;g--;)f.unshift(e.toLocaleTimeString().replace(/^\D*/,"")),e=new Date(e-1e4);k.xAxis[0].data=f,k.series[0].data=c,k.series[1].data=b,j.setOption(k)})}function d(){var a=(new Date).toLocaleTimeString().replace(/^\D*/,"");$.get("/systemdata/updateSendData.do").done(function(b){var c=k.xAxis[0].data,d=k.series[0].data,e=k.series[1].data;c.push(a),c.length>100?c.splice(0,1):null,d.push(parseInt(b.data.requestData,10)),d.length>100?d.splice(0,1):null,e.push(parseInt(b.data.deliveredData,10)),e.length>100?e.splice(0,1):null,k.xAxis[0].data=c,k.series[0].data=d,k.series[1].data=e,j.setOption(k)})}var e={1:"安徽",2:"浙江",3:"江西",4:"江苏",5:"吉林",6:"青海",7:"福建",8:"黑龙江",9:"河南",10:"河北",11:"湖北",12:"湖南",13:"新疆",14:"西藏",15:"甘肃",16:"广西",18:"贵州",19:"辽宁",20:"内蒙古",21:"宁夏",22:"北京",23:"上海",24:"山西",25:"山东",26:"陕西",28:"天津",29:"云南",30:"广东",31:"海南",32:"四川",33:"重庆"},f={"安徽":[117.230957,31.826208],"浙江":[120.163608,30.280703],"江西":[115.861333,28.686536],"江苏":[118.799921,32.06458],"吉林":[125.329165,43.821377],"青海":[101.784594,36.622667],"福建":[119.30205,26.079321],"黑龙江":[126.541584,45.807814],"河南":[113.630097,34.7542],"河北":[114.517483,38.048503],"湖北":[114.31667,30.51667],"湖南":[112.944283,28.234357],"新疆":[87.621905,43.833305],"西藏":[91.120227,29.649751],"甘肃":[103.841702,36.068427],"广西":[108.372548,22.823549],"贵州":[106.636738,26.651607],"辽宁":[123.43969,41.811226],"内蒙古":[111.756362,40.847532],"宁夏":[106.238099,38.492229],"北京":[116.415372,39.911347],"上海":[121.481,31.236318],"山西":[112.555463,37.877974],"山东":[117.000821,36.670281],"陕西":[108.951373,34.264913],"天津":[117.186092,39.139453],"云南":[102.710577,25.042344],"广东":[113.269706,23.134938],"海南":[110.338563,20.026418],"四川":[104.071373,30.662548],"重庆":[106.557656,29.570242]},g={backgroundColor:"#1b1b1b",color:["gold","aqua"],title:{text:"系统打开点击数据",subtext:"采样",x:"center",textStyle:{color:"#fff"}},tooltip:{trigger:"item",formatter:"{b}"},legend:{orient:"vertical",x:"left",data:["打开","点击"],textStyle:{color:"#fff"}},toolbox:{show:!1,orient:"vertical",x:"right",y:"center",feature:{mark:{show:!0},dataView:{show:!0,readOnly:!1},restore:{show:!0},saveAsImage:{show:!0}}},series:[{name:"打开",type:"map",hoverable:!1,mapType:"china",itemStyle:{normal:{borderColor:"rgba(100,149,237,1)",borderWidth:.5,areaStyle:{color:"#1b1b1b"}}},data:[],markPoint:{symbol:"emptyCircle",symbolSize:function(a){return 10+a/10},effect:{show:!0,shadowBlur:0},itemStyle:{normal:{label:{show:!1}},emphasis:{label:{position:"top"}}},data:[]}},{name:"点击",type:"map",mapType:"china",data:[],markPoint:{symbol:"emptyCircle",symbolSize:function(a){return 15+a/10},effect:{show:!0,shadowBlur:0},itemStyle:{normal:{label:{show:!1}},emphasis:{label:{position:"top"}}},data:[]}}]};b(),setInterval(b,6e4);var h=a.init(document.getElementById("map-chart"));h.setOption(g);var j=a.init(document.getElementById("line-chart")),k={title:{text:"请求发送数据",subtext:"每10s更新"},color:["#629bf9","#fe6e6e"],tooltip:{trigger:"axis"},legend:{data:["请求数","发送数"]},xAxis:[{type:"category",boundaryGap:!1,data:""}],yAxis:[{axisLabel:{formatter:"{value} 封"}}],series:[{name:"请求数",type:"line",smooth:!0,data:[]},{name:"发送数",type:"line",smooth:!0,data:[]}]};c();setInterval(d,2e3)});